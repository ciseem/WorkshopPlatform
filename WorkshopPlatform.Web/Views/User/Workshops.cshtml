@using WorkshopPlatform.Core.Entities
@using WorkshopPlatform.Core.Enums
@{
    ViewData["Title"] = "Workshoplarım";
    var createdWorkshops = ViewBag.CreatedWorkshops as IEnumerable<Workshop>;
    var joinedParticipations = ViewBag.JoinedParticipations as IEnumerable<WorkshopKatilimci>;
}

<style>
    .premium-tabs {
        display: flex;
        gap: 0.5rem;
        background: #fff;
        padding: 0.5rem;
        border-radius: 14px;
        border: 1px solid var(--gray-200);
        margin-bottom: 2.5rem;
        box-shadow: var(--shadow-sm);
        width: fit-content;
    }

    .tab-link {
        padding: 0.75rem 1.5rem;
        border: none;
        background: transparent;
        color: var(--gray-600);
        font-weight: 700;
        font-size: 0.95rem;
        cursor: pointer;
        border-radius: 10px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .tab-link i {
        font-size: 1.1rem;
        opacity: 0.7;
    }

    .tab-link:hover {
        color: var(--primary);
        background: var(--gray-100);
    }

    .tab-link.active {
        background: var(--primary);
        color: white;
        box-shadow: 0 4px 12px rgba(30, 64, 175, 0.2);
    }

    .tab-link.active i {
        opacity: 1;
    }

    .workshop-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 2rem;
    }
</style>

<div class="premium-tabs">
    <button class="tab-link active" onclick="openTab(event, 'created')">
        <i class="fas fa-user-tie"></i> Yönettiğim Workshoplar
    </button>
    <button class="tab-link" onclick="openTab(event, 'joined')">
        <i class="fas fa-graduation-cap"></i> Katıldığım Workshoplar
    </button>
</div>

<div id="created" class="tab-content">
    <div class="workshop-grid">
        @if (createdWorkshops != null && createdWorkshops.Any())
        {
            foreach (var item in createdWorkshops)
            {
                <div class="premium-card workshop-card glass-effect">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                        <span class="badge @(item.Durum == WorkshopDurum.Aktif ? "badge-success" : "badge-gray")">
                            @item.Durum
                        </span>
                        <span style="font-size: 0.75rem; color: var(--secondary);">@item.Kategori</span>
                    </div>
                    <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 0.5rem;">@item.Baslik</h3>
                    <div style="margin-bottom: 1.5rem; font-size: 0.875rem; color: var(--secondary);">
                        <i class="fas fa-layer-group"></i> @item.Seanslar.Count Seans Mevcut
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="font-weight: 600; color: var(--primary);">@(item.UcretliMi ? $"{item.Fiyat:C2}" : "Ücretsiz")</div>
                        <a asp-controller="Workshop" asp-action="Detail" asp-route-id="@item.Id" class="premium-btn-sm">Yönet</a>
                    </div>
                </div>
            }
        }
        else
        {
            <p style="color: var(--secondary);">Henüz bir workshop oluşturmadınız.</p>
        }
    </div>
</div>

<div id="joined" class="tab-content" style="display:none;">
    <div class="workshop-grid">
        @if (joinedParticipations != null && joinedParticipations.Any())
        {
            foreach (var item in joinedParticipations)
            {
                <div class="premium-card workshop-card glass-effect">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                        <span class="badge" style="background: var(--primary-light); color: var(--primary);">
                            @item.KatilimDurumu
                        </span>
                        <span style="font-size: 0.75rem; color: var(--secondary);">@item.Seans.Tarih.ToShortDateString()</span>
                    </div>
                    <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 0.5rem;">@item.Seans.Workshop.Baslik</h3>
                    <div style="margin-bottom: 1.5rem; font-size: 0.875rem; color: var(--secondary);">
                        <i class="fas fa-user-circle"></i> @item.Seans.Workshop.OlusturanKullanici.AdSoyad
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="font-size: 0.875rem; font-weight: 500;">Saat: @item.Seans.Saat.ToString(@"hh\:mm")</div>
                        <a asp-controller="Workshop" asp-action="Detail" asp-route-id="@item.Seans.WorkshopId" class="premium-btn-sm" style="background: var(--primary);">Detaylar</a>
                    </div>
                </div>
            }
        }
        else
        {
            <p style="color: var(--secondary);">Henüz bir workshopa katılmadınız.</p>
        }
    </div>
</div>

@section Scripts {
    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tab-link");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }
    </script>
}
